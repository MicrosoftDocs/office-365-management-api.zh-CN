---
ms.TocTitle: Office 365 Management Activity API frequently asked questions
title: Office 365 管理活动 API 常见问题解答
description: 有关使用 Office 365 管理活动 API 的常见问题解答
ms.ContentId: ''
ms.topic: reference (API)
ms.date: ''
localization_priority: Priority
ms.openlocfilehash: 2abcdd71c75cab011fa8e711832b06d398e3a6ab
ms.sourcegitcommit: 289cf45903a045630f4b3efba6f03494bf08ab4a
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/17/2019
ms.locfileid: "35772112"
---
# <a name="office-365-management-activity-api-frequently-asked-questions"></a><span data-ttu-id="e8868-103">Office 365 管理活动 API 常见问题解答</span><span class="sxs-lookup"><span data-stu-id="e8868-103">Office 365 Management Activity API frequently asked questions</span></span>

#### <a name="what-events-are-audited-for-a-specific-office-365-service"></a><span data-ttu-id="e8868-104">要对特定 Office 365 服务审核什么事件？</span><span class="sxs-lookup"><span data-stu-id="e8868-104">What events are audited for a specific Office 365 service?</span></span>

<span data-ttu-id="e8868-105">“Office 365 管理活动 API 架构”一文列出了全部事件。</span><span class="sxs-lookup"><span data-stu-id="e8868-105">Office 365 Management Activity API schema documentation has a comprehensive list of events.</span></span> <span data-ttu-id="e8868-106">有关详细信息，请参阅 [Office 365 管理活动 API 架构](office-365-management-activity-api-schema.md)。</span><span class="sxs-lookup"><span data-stu-id="e8868-106">For details, see [Office 365 Management Activity API schema](office-365-management-activity-api-schema.md).</span></span> <span data-ttu-id="e8868-107">另请参阅[在安全与合规中心内搜索审核日志](https://docs.microsoft.com/zh-CN/office365/securitycompliance/search-the-audit-log-in-security-and-compliance#audited-activities)中的“已审核的活动”部分，以获取大多数已审核的 Office 365 服务的事件列表。</span><span class="sxs-lookup"><span data-stu-id="e8868-107">Also see the "Audited activities" section in [Search the audit log in the Security & Compliance Center](https://docs.microsoft.com/en-us/office365/securitycompliance/search-the-audit-log-in-security-and-compliance#audited-activities) for a list of events for most of the Office 365 services that are audited.</span></span>

#### <a name="how-do-i-onboard-to-the-management-activity-api"></a><span data-ttu-id="e8868-108">如何上手使用管理活动 API？</span><span class="sxs-lookup"><span data-stu-id="e8868-108">How do I onboard to the Management Activity API?</span></span>

<span data-ttu-id="e8868-109">若要开始使用 Office 365 管理活动 API，请参阅 [Office 365 管理 API 入门](get-started-with-office-365-management-apis.md)。</span><span class="sxs-lookup"><span data-stu-id="e8868-109">To get started with the Office 365 Management Activity API, see [Get started with Office 365 Management APIs](get-started-with-office-365-management-apis.md).</span></span>
 
#### <a name="what-is-the-throttling-limit-for-the--management-activity-api"></a><span data-ttu-id="e8868-110">管理活动 API 的限制是什么？</span><span class="sxs-lookup"><span data-stu-id="e8868-110">What is the throttling limit for the  Management Activity API?</span></span>

<span data-ttu-id="e8868-111">目前，每个发布者 ID 每分钟的请求数不得超过 6 万个。</span><span class="sxs-lookup"><span data-stu-id="e8868-111">The current throttling limit is 60K requests/minute per Publisher ID.</span></span> 

#### <a name="we-want-to-programmatically-capture-all-events-in-all-workloads-what-is-the-most-reliable-way-to-do-this"></a><span data-ttu-id="e8868-112">我们希望以编程方式捕获所有工作负载中的全部事件。</span><span class="sxs-lookup"><span data-stu-id="e8868-112">We want to programmatically capture all events in all workloads.</span></span> <span data-ttu-id="e8868-113">实现此目标的最可靠方法是什么？</span><span class="sxs-lookup"><span data-stu-id="e8868-113">What is the most reliable way to do this?</span></span>

<span data-ttu-id="e8868-114">为此，可使用 Office 365 管理活动 API。</span><span class="sxs-lookup"><span data-stu-id="e8868-114">You can do this by using the Office 365 Management Activity API.</span></span> <span data-ttu-id="e8868-115">此外，由于无法使用 Webhook，因此还建议使用**请求模型**。</span><span class="sxs-lookup"><span data-stu-id="e8868-115">Also, we recommend that you use the **pull model** due to issues with using webhooks.</span></span> <span data-ttu-id="e8868-116">有关详细信息，请参阅 [Office 365 管理活动 API 疑难解答](troubleshooting-the-office-365-management-activity-api.md#using-webhooks)中的“使用 Webhook”部分。</span><span class="sxs-lookup"><span data-stu-id="e8868-116">For more information, see the "Using webhooks" section in [Troubleshooting the Office 365 Management Activity API](troubleshooting-the-office-365-management-activity-api.md#using-webhooks).</span></span>

#### <a name="is-it-true-that-mailbox-auditing-in-exchange-online-can-only-be-enabled-by-using-powershell"></a><span data-ttu-id="e8868-117">Exchange Online 中的邮箱审核是否只能使用 PowerShell 启用？</span><span class="sxs-lookup"><span data-stu-id="e8868-117">Is it true that mailbox auditing in Exchange Online can only be enabled by using PowerShell?</span></span>

<span data-ttu-id="e8868-118">过去是这样，但自 2019 年 1 月起，所有 Office 365 组织都会默认启用邮箱审核。</span><span class="sxs-lookup"><span data-stu-id="e8868-118">That used to be the case but since January 2019, mailbox auditing is now turned on by default for all Office 365 organizations.</span></span> <span data-ttu-id="e8868-119">有关详细信息，请参阅[管理邮箱审核](https://docs.microsoft.com/office365/securitycompliance/enable-mailbox-auditing)。</span><span class="sxs-lookup"><span data-stu-id="e8868-119">For more information, see [Manage on-premises mailbox moves in Exchange 2016](https://docs.microsoft.com/office365/securitycompliance/enable-mailbox-auditing).</span></span>

#### <a name="are-there-any-differences-in-the-records-that-are-fetched-by-the-management-activity-api-versus-the-records-that-are-returned-by-using-the-audit-log-search-tool-in-the-office-365-security--compliance-center"></a><span data-ttu-id="e8868-120">管理活动 API 提取的记录与使用 Office 365 安全与合规中心内的审核日志搜索工具返回的记录是否有何不同？</span><span class="sxs-lookup"><span data-stu-id="e8868-120">Are there any differences in the records that are fetched by the Management Activity API versus the records that are returned by using the audit log search tool in the Office 365 Security & Compliance Center?</span></span>

<span data-ttu-id="e8868-121">这两种方法返回的数据是相同的。</span><span class="sxs-lookup"><span data-stu-id="e8868-121">The data that is returned by both methods is the same.</span></span> <span data-ttu-id="e8868-122">数据并未经过筛选。</span><span class="sxs-lookup"><span data-stu-id="e8868-122">There is no filtering that happens.</span></span> <span data-ttu-id="e8868-123">唯一区别是：使用 API 可一次获取过去 7 天的数据；</span><span class="sxs-lookup"><span data-stu-id="e8868-123">The only difference is that with the API, you can get data for the last 7 days at a time.</span></span> <span data-ttu-id="e8868-124">在安全与合规中心内搜索审核日志（或在 Exchange Online 中使用相应的 [Search-unifiedauditlog](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance-audit/search-unifiedauditlog) cmdlet），可获取过去 90 天的数据。</span><span class="sxs-lookup"><span data-stu-id="e8868-124">When searching the audit log in the Security & Compliance Center (or by using the corresponding [Search-UnifiedAuditLog](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance-audit/search-unifiedauditlog) cmdlet in Exchange Online), you can get data for the last 90 days.</span></span> 
 
#### <a name="arent-webhook-notifications-more-immediate-after-all-arent-they-event-driven"></a><span data-ttu-id="e8868-125">Webhook 通知不是更即时吗？</span><span class="sxs-lookup"><span data-stu-id="e8868-125">Aren’t webhook notifications more immediate?</span></span> <span data-ttu-id="e8868-126">毕竟它们是事件驱动通知，不是吗？</span><span class="sxs-lookup"><span data-stu-id="e8868-126">After all, aren’t they event-driven?</span></span>

<span data-ttu-id="e8868-127">不是。</span><span class="sxs-lookup"><span data-stu-id="e8868-127">No.</span></span> <span data-ttu-id="e8868-128">Webhook 通知并不是事件触发通知意义上的事件驱动通知。</span><span class="sxs-lookup"><span data-stu-id="e8868-128">Webhook notifications aren't event-driven in the sense that the event triggers the notification.</span></span> <span data-ttu-id="e8868-129">仍必须创建内容 blob，而创建内容 blob 则会触发通知传递。</span><span class="sxs-lookup"><span data-stu-id="e8868-129">The content blob must still be created, and the creation of the content blob is what triggers the notification delivery.</span></span> <span data-ttu-id="e8868-130">最近，与直接使用 */content* 操作查询 API 相比，使用 Webhook 的通知等待时间更长。</span><span class="sxs-lookup"><span data-stu-id="e8868-130">Recently, there have been longer wait times for notifications when using a webhook compared to querying the API directly with the */content* operation.</span></span> <span data-ttu-id="e8868-131">因此，不得将管理活动 API 视为实时安全警报系统。</span><span class="sxs-lookup"><span data-stu-id="e8868-131">Therefore, the Management Activity API shouldn’t be thought of as a real-time security alert system.</span></span> <span data-ttu-id="e8868-132">对于这一领域，Microsoft 有其他产品。</span><span class="sxs-lookup"><span data-stu-id="e8868-132">Microsoft has other products for that.</span></span> <span data-ttu-id="e8868-133">就安全性而言，管理活动 API 事件通知可能更适用于确定长时间的使用模式。</span><span class="sxs-lookup"><span data-stu-id="e8868-133">As far as security is concerned, Management Activity API event notifications can more appropriately be used to determine usage patterns over extended periods of time.</span></span>

#### <a name="when-pulling-the-data-from-the-management-activity-api-there-is-sometimes-a-delay-of-more-than-3-to-5-days-why-is-this"></a><span data-ttu-id="e8868-134">使用管理活动 API 拉取数据时，有时会有超过 3 到 5 天的延迟。</span><span class="sxs-lookup"><span data-stu-id="e8868-134">When pulling the data from the Management Activity API, there is sometimes a delay of more than 3 to 5 days.</span></span> <span data-ttu-id="e8868-135">这是什么原因？</span><span class="sxs-lookup"><span data-stu-id="e8868-135">Why is this?</span></span>

<span data-ttu-id="e8868-136">有时，Office 365 服务会出现暂时中断或其他问题。</span><span class="sxs-lookup"><span data-stu-id="e8868-136">At times, there are instances of a temporary outage or other issues in the Office 365 service.</span></span> <span data-ttu-id="e8868-137">在这种情况下，一些审核记录会遭删除，而服务则会尝试回填这些记录。</span><span class="sxs-lookup"><span data-stu-id="e8868-137">In those cases, some audit records are dropped and the service tries to backfill them.</span></span> <span data-ttu-id="e8868-138">虽然只有大约 5% 到 10% 的记录会出现这种情况，但正是这些记录导致了在某些情况下可能会发生的延迟。</span><span class="sxs-lookup"><span data-stu-id="e8868-138">Although this happens for only about 5% to 10% of the records, these are the records that may be delayed in certain situations.</span></span> <span data-ttu-id="e8868-139">如果延迟超过 5 天，请检查 Office 365 管理中心内的服务运行状况仪表板。</span><span class="sxs-lookup"><span data-stu-id="e8868-139">If the delay is more than 5 days, check the Service Health Dashboard in the Office 365 admin center.</span></span> <span data-ttu-id="e8868-140">如果需要，还可以开启 [Microsoft 支持](https://support.office.com/article/contact-support-for-business-products-admin-help-32a17ca7-6fa0-4870-8a8d-e25ba4ccfd4b#ID0EAADAAA=online)票证。</span><span class="sxs-lookup"><span data-stu-id="e8868-140">If needed, you can also open a ticket with [Microsoft support](https://support.office.com/article/contact-support-for-business-products-admin-help-32a17ca7-6fa0-4870-8a8d-e25ba4ccfd4b#ID0EAADAAA=online).</span></span>

#### <a name="im-encountering-a-throttling-error-in-the-management-activity-api-what-should-i-do"></a><span data-ttu-id="e8868-141">我在使用管理活动 API 时遇到了限制错误。</span><span class="sxs-lookup"><span data-stu-id="e8868-141">I'm encountering a throttling error in the Management Activity API.</span></span> <span data-ttu-id="e8868-142">该怎么办？</span><span class="sxs-lookup"><span data-stu-id="e8868-142">What should I do?</span></span>

<span data-ttu-id="e8868-143">开启 [Microsoft 支持](https://support.office.com/article/contact-support-for-business-products-admin-help-32a17ca7-6fa0-4870-8a8d-e25ba4ccfd4b#ID0EAADAAA=online)票证，申请新限制，并添加提高限制的正当业务理由。</span><span class="sxs-lookup"><span data-stu-id="e8868-143">Open a ticket with [Microsoft Support](https://support.office.com/article/contact-support-for-business-products-admin-help-32a17ca7-6fa0-4870-8a8d-e25ba4ccfd4b#ID0EAADAAA=online) and request a new throttling limit, and include a business justification for increasing the limit.</span></span> <span data-ttu-id="e8868-144">我们将会评估申请，如果接受，便会提高限制。</span><span class="sxs-lookup"><span data-stu-id="e8868-144">We will evaluate the request, and if accepted, we will increase the throttling limit.</span></span>

#### <a name="what-happens-if-i-disable-auditing-for-my-office-365-organization-will-i-still-get-events-via-the-management-activity-api"></a><span data-ttu-id="e8868-145">如果禁用 Office 365 组织审核，会出现什么情况？</span><span class="sxs-lookup"><span data-stu-id="e8868-145">What happens if I disable auditing for my Office 365 organization?</span></span> <span data-ttu-id="e8868-146">是否仍可通过管理活动 API 获得事件？</span><span class="sxs-lookup"><span data-stu-id="e8868-146">Will I still get events via the Management Activity API?</span></span>

<span data-ttu-id="e8868-147">不可以。</span><span class="sxs-lookup"><span data-stu-id="e8868-147">No.</span></span> <span data-ttu-id="e8868-148">必须为组织启用审核，才能通过管理活动 API 拉取记录。</span><span class="sxs-lookup"><span data-stu-id="e8868-148">Auditing must be enabled for your organization to pull records via the Management Activity API.</span></span>

#### <a name="why-are-targetupdatedproperties-no-longer-in-extendedproperties-in-the-audit-logs-for-azure-active-directory-activities"></a><span data-ttu-id="e8868-149">TargetUpdatedProperties 为何不再位于 Azure Active Directory 活动审核日志的 ExtendedProperties 中？</span><span class="sxs-lookup"><span data-stu-id="e8868-149">Why are TargetUpdatedProperties no longer in ExtendedProperties in the audit logs for Azure Active Directory activities?</span></span>

<span data-ttu-id="e8868-150">TargetUpdatedProperties 显示在 ExtendedProperties 中。</span><span class="sxs-lookup"><span data-stu-id="e8868-150">TargetUpdatedProperties were appearing in ExtendedProperties.</span></span> <span data-ttu-id="e8868-151">但是，它们将从 ExtendedProperties 中删除，并且现在将显示在 ModifiedProperties 中。</span><span class="sxs-lookup"><span data-stu-id="e8868-151">However, they have been removed from ExtendedProperties and will now appear in ModifiedProperties.</span></span>
